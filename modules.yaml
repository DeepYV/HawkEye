architecturePrinciples:
  nonNegotiable:
    - "Separation of concerns"
    - "Conservative defaults"
    - "No single module is \"smart\" alone"
    - "Explainability over intelligence"
    - "Silence is success when uncertain"

modules:
  - id: module_1
    name: "Frontend Observer SDK"
    purpose: "Capture normalized, privacy-safe user behavior"
    location: "Customer app"
    characteristics:
      - Passive
      - Lightweight
      - "No decisions made here"
    responsibility: "Emit normalized events only"
    output: "Normalized events"
    constraints:
      - "No business logic"
      - "No analysis"
      - "Privacy-safe (field masking)"

  - id: module_2
    name: "Event Ingestion API"
    purpose: "Receive, validate, and store events"
    responsibilities:
      - "Authentication (API key)"
      - Validation
      - "Rate limiting"
      - "No analysis"
    output: "Forwards events to session manager"
    constraints:
      - "No business logic"
      - "No signal detection"
      - "Pure validation and forwarding"

  - id: module_3
    name: "Session Manager"
    purpose: "Define session boundaries correctly"
    responsibilities:
      - "Groups events into sessions"
      - "Enforces time & context isolation"
      - "Prevents cross-session correlation"
    output: "Emits complete sessions downstream"
    constraints:
      - "No signal detection"
      - "No frustration analysis"
      - "Pure session boundary management"
    criticalRules:
      - "Session boundaries are trusted and final"
      - "No cross-session correlation allowed"

  - id: module_4
    name: "User Frustration Signal Engine (UFSE)"
    purpose: "Detect frustration & confusion"
    type: "CORE INTELLECTUAL PROPERTY"
    responsibilities:
      - "Detects frustration & confusion"
      - "Correlates signals"
      - "Applies strict thresholds"
      - "Emits only high-confidence incidents"
    output: "Frustration Incidents (high-confidence only)"
    input:
      type: "Completed session object"
      includes:
        - "Ordered list of normalized events"
        - "Session metadata (route, device, app version)"
    constraints:
      - "No UI knowledge"
      - "No AI knowledge"
      - "No Jira/Linear knowledge"
      - "No SDK internals knowledge"
      - "Only knows about sessions and events"
    emissionRules:
      - "Only High confidence incidents are emitted"
      - "Medium / Low confidence are discarded"
      - "If confidence is insufficient â†’ emit nothing"

  - id: module_5
    name: "Incident Store"
    purpose: "Source of truth for validated incidents"
    responsibilities:
      - "Stores incidents"
      - "Enables deduplication"
      - "Downstream consumers read from here"
    output: "Stored incidents (read-only for consumers)"
    constraints:
      - "No signal detection"
      - "No analysis"
      - "Pure storage and retrieval"

  - id: module_6
    name: "AI Interpretation Module"
    purpose: "Convert incidents into human-readable summaries"
    stage: Later
    characteristics:
      - Async
      - "Never in hot path"
      - Optional
    constraints:
      - "Post-incident only"
      - "Never blocks core path"
      - "Optional enhancement"

  - id: module_7
    name: "Ticket Generator"
    purpose: "Create Jira / Linear tickets"
    responsibilities:
      - "Consumes only high-confidence incidents"
      - Deduplicates
      - "Applies workflow rules"
    input: "High-confidence incidents from Incident Store"
    output: "Tickets in external systems"
    constraints:
      - "No signal detection"
      - "No analysis"
      - "Pure integration logic"