{
  "module": "Frontend Observer SDK",
  "version": "1.0",
  "instructions": {
    "role": {
      "title": "Your Role",
      "description": "You are building ONE frontend module: Frontend Observer SDK",
      "runtime": "Runs inside customer React / Next.js applications",
      "job": "Observe and emit normalized, privacy-safe user interaction events",
      "mustNotDo": [
        "Analyze",
        "Decide",
        "Score",
        "Judge"
      ]
    },
    "coreObjective": {
      "title": "Core Objective (Do Not Deviate)",
      "requirements": [
        "Be extremely easy to integrate",
        "Have near-zero performance impact",
        "Be safe by default",
        "Emit clean, normalized events",
        "Never produce false signals itself"
      ],
      "rule": "If unsure → do not capture."
    },
    "scopeBoundaries": {
      "title": "Strict Scope Boundaries",
      "mustBuild": [
        "SDK initialization",
        "Event observation",
        "Event normalization",
        "Event batching & sending",
        "Privacy & masking safeguards"
      ],
      "mustNotBuild": [
        "Session replay / video",
        "Frustration detection",
        "AI logic",
        "Ticket creation",
        "Dashboards or UI",
        "Business logic interpretation"
      ],
      "rule": "If you do any of the above → it is wrong."
    },
    "integrationExperience": {
      "title": "Integration Experience (Critical)",
      "requirements": [
        "One import",
        "One init call",
        "No configuration required"
      ],
      "exampleExperience": "Install, initialize, forget.",
      "configuration": {
        "allowed": "Optional configuration is allowed but never required"
      }
    },
    "initialization": {
      "title": "SDK Initialization Responsibilities",
      "onInit": [
        "Validate API key exists",
        "Generate a session identifier",
        "Capture environment metadata",
        "Register observers safely",
        "Fail silently if misconfigured"
      ],
      "criticalRule": "SDK must never crash the host app."
    },
    "observations": {
      "title": "What the SDK Observes",
      "userInteractionEvents": {
        "allowed": [
          "Clicks",
          "Scroll start / end",
          "Input focus / blur",
          "Form submit attempts",
          "Navigation / route change"
        ],
        "rules": [
          "Capture intent, not content",
          "Never capture input values",
          "Never infer meaning"
        ]
      },
      "systemFeedbackEvents": {
        "allowed": [
          "JS runtime errors",
          "Network request failure / success (status only)",
          "Long task / slow response indicators",
          "Loading start / end markers"
        ],
        "rules": [
          "Metadata only",
          "No payloads",
          "No headers",
          "No response bodies"
        ]
      },
      "contextEvents": {
        "allowed": [
          "Route / URL path",
          "Component identifier (if explicitly provided)",
          "App version",
          "Device & browser info"
        ]
      }
    },
    "privacyRules": {
      "title": "Privacy Rules (Non-Negotiable)",
      "must": [
        "Mask all input values",
        "Ignore password, OTP, credit card fields",
        "Ignore explicitly marked sensitive elements",
        "Avoid capturing inner text by default"
      ],
      "mustNot": [
        "Record keystrokes",
        "Capture PII",
        "Capture DOM snapshots",
        "Capture screenshots"
      ],
      "rule": "If in doubt → drop the event."
    },
    "eventNormalization": {
      "title": "Event Normalization Rules",
      "characteristics": [
        "Flat",
        "Structured",
        "Predictable",
        "Deterministic"
      ],
      "requiredFields": [
        "Event type",
        "Timestamp",
        "Session ID",
        "Route",
        "Target identifier (hashed or abstracted)",
        "Metadata (minimal)"
      ],
      "mustNotInclude": [
        "Raw DOM nodes",
        "Complex objects"
      ]
    },
    "performanceConstraints": {
      "title": "Performance Constraints",
      "requirements": [
        "Be non-blocking",
        "Use async observers",
        "Batch events",
        "Throttle high-frequency events",
        "Yield to browser idle time when possible"
      ],
      "hardRequirement": "SDK must never noticeably impact user experience."
    },
    "eventTransport": {
      "title": "Event Transport Rules",
      "characteristics": [
        "Events are buffered",
        "Sent in batches",
        "Sent over HTTP",
        "Retries are allowed",
        "Failures are silent"
      ],
      "networkFailureBehavior": [
        "Drop events gracefully",
        "Do not block UI",
        "Do not log noisy errors"
      ]
    },
    "sessionHandling": {
      "title": "Session Handling (Frontend Side)",
      "responsibilities": [
        "Generates a session ID",
        "Resets session on page reload"
      ],
      "mustNotDo": [
        "Define session end logic"
      ],
      "note": "Session lifecycle decisions belong to backend."
    },
    "configuration": {
      "title": "Configuration (Optional Only)",
      "allowedOptionalConfig": [
        "Disable specific event types",
        "Ignore specific routes",
        "Mark custom sensitive selectors",
        "Enable debug mode (console logs)"
      ],
      "requirements": [
        "Be optional",
        "Have safe defaults",
        "Never be required"
      ]
    },
    "debugExplainability": {
      "title": "Debug & Explainability (Developer Trust)",
      "whenDebugEnabled": [
        "Log what events are captured",
        "Log why events are ignored",
        "Never expose sensitive data"
      ],
      "purpose": "This is for developer trust, not end users."
    },
    "explicitAvoidances": {
      "title": "What You Must Explicitly Avoid",
      "avoid": [
        "Heavy dependencies",
        "Build-time plugins",
        "Framework-specific coupling",
        "Magic heuristics",
        "Silent breaking behavior"
      ],
      "principle": "The SDK must feel boring, predictable, and safe."
    },
    "acceptanceCriteria": {
      "title": "Acceptance Criteria (Must Pass)",
      "criteria": [
        "Can be integrated in <5 minutes",
        "Does not break host apps",
        "Captures only allowed events",
        "Emits normalized data",
        "Respects privacy strictly",
        "Does nothing when uncertain"
      ]
    },
    "designPhilosophy": {
      "title": "Design Philosophy (Follow Exactly)",
      "principles": [
        "Observe, don't interpret",
        "Safe > complete",
        "Invisible > powerful",
        "Predictable > clever"
      ],
      "note": "This SDK is the foundation of trust."
    },
    "finalInstruction": {
      "title": "FINAL INSTRUCTION FOR CURSOR",
      "rule": "If a feature:",
      "exclusions": [
        "Adds intelligence",
        "Makes assumptions",
        "Interprets behavior",
        "Risks privacy",
        "Increases bundle size unnecessarily"
      ],
      "action": "DO NOT IMPLEMENT IT. Build only what is described here."
    }
  },
  "technicalSpecifications": {
    "bundleSize": "<10KB gzipped",
    "dependencies": "No dependencies where possible",
    "runtime": "Browser only",
    "buildTimePlugins": false,
    "frameworkSupport": [
      "React",
      "Next.js (App Router + Pages)",
      "Framework-agnostic core (DOM-based)"
    ]
  },
  "eventTypes": {
    "userInteraction": {
      "clicks": {
        "capture": "Target element, coordinates, timestamp",
        "exclude": "Input values, inner text"
      },
      "scroll": {
        "capture": "Scroll start/end, direction, distance",
        "exclude": "Page content"
      },
      "input": {
        "capture": "Focus/blur events, field type",
        "exclude": "Input values, keystrokes"
      },
      "formSubmit": {
        "capture": "Form identifier, submit attempt",
        "exclude": "Form data, field values"
      },
      "navigation": {
        "capture": "Route change, URL path",
        "exclude": "Query parameters with PII"
      }
    },
    "systemFeedback": {
      "errors": {
        "capture": "Error type, message (sanitized), stack trace (sanitized)",
        "exclude": "Sensitive data in stack traces"
      },
      "network": {
        "capture": "Request URL (sanitized), status code, duration",
        "exclude": "Request/response payloads, headers, query parameters"
      },
      "performance": {
        "capture": "Long task duration, slow response indicators",
        "exclude": "Detailed performance metrics"
      },
      "loading": {
        "capture": "Loading start/end markers",
        "exclude": "Resource details"
      }
    },
    "context": {
      "route": {
        "capture": "URL path (sanitized)",
        "exclude": "Query parameters, hash fragments with PII"
      },
      "component": {
        "capture": "Component identifier (if explicitly provided)",
        "exclude": "Component state, props"
      },
      "environment": {
        "capture": "App version, device type, browser info",
        "exclude": "Device identifiers, user agent details"
      }
    }
  },
  "privacySafeguards": {
    "fieldMasking": {
      "automatic": [
        "password",
        "otp",
        "credit-card",
        "ssn",
        "email (configurable)"
      ],
      "custom": "Explicitly marked sensitive selectors"
    },
    "dataExclusion": {
      "neverCapture": [
        "Input values",
        "Keystrokes",
        "DOM snapshots",
        "Screenshots",
        "PII in any form"
      ]
    },
    "sanitization": {
      "urls": "Remove query parameters, hash fragments",
      "errors": "Sanitize stack traces",
      "selectors": "Hash or abstract element identifiers"
    }
  },
  "performanceOptimizations": {
    "batching": {
      "strategy": "Collect events, send in batches",
      "batchSize": "Configurable (default: 10 events or 5 seconds)",
      "maxBatchSize": 50
    },
    "throttling": {
      "highFrequencyEvents": "Throttle scroll, mousemove events",
      "throttleInterval": "100ms for high-frequency events"
    },
    "asyncOperations": {
      "observers": "Use async/requestIdleCallback when available",
      "network": "Non-blocking HTTP requests",
      "processing": "Defer to next event loop tick"
    }
  }
}